# .kube/config
- name: ".kube - create ~/.kube directory"
  ansible.builtin.file:
    path: "{{ ansible_home }}/.kube"
    state: directory
    mode: "0755"

- name: ".kube - check src Win path {{ args.win_path }} exists"
  ansible.builtin.stat:
    path: "{{ args.win_path }}"
  register: win_kube_stat_result

- name: ".kube - check Linux path {{ args.linux_path }} is link"
  ansible.builtin.stat:
    path: "{{ ansible_home }}/{{ args.linux_path }}"
  register: linux_kube_link

- name: ".kube - delete linux default file"
  ansible.builtin.file:
    path: "{{ ansible_home }}/{{ args.linux_path }}"
    state: absent
  when: (win_kube_stat_result.stat.exists) and (linux_kube_link.stat.exists) and (not linux_kube_link.stat.islnk)

- name: ".kube - create symlinks with Win path"
  ansible.builtin.file:
    src: "{{ args.win_path }}"
    dest: "{{ ansible_home }}/{{ args.linux_path }}"
    state: link
  when: win_kube_stat_result.stat.exists
