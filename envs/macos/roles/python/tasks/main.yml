---

- name: clone pyenv-virtualenv repository
  git:
    repo: https://github.com/pyenv/pyenv-virtualenv.git
    dest: ~/.pyenv/plugins/pyenv-virtualenv
    accept_hostkey: yes

- name: pickup installed python versions
  shell: pyenv versions | grep {{ python_version }}
  register: pyenv_version
  changed_when: false
  ignore_errors: yes

- name: install python
  shell: pyenv install {{ python_version }}
  when: pyenv_version is failed
