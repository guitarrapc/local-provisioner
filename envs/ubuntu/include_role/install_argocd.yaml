- name: "argocd - check installed"
  shell: argocd version | grep {{ args.version }}
  register: argocd_exists
  changed_when: false
  ignore_errors: yes

- name: "argocd - download"
  become: yes
  get_url:
    url: https://github.com/argoproj/argo-cd/releases/download/v{{ args.version }}/argocd-linux-amd64
    dest: "/usr/local/bin/argocd"
  register: download_argocd
  when: argocd_exists is failed

- name: "argocd - change file permissions"
  become: yes
  file:
    path: /usr/local/bin/argocd
    mode: "0755"
