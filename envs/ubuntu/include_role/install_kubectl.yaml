- name: "kubectl - check installed"
  shell: kubectl version --client --short | grep {{ args.version }}
  register: kubectl_exists
  changed_when: false
  ignore_errors: yes

- name: "kubectl - download"
  become: yes
  shell: curl -Lks "https://storage.googleapis.com/kubernetes-release/release/{{ args.version }}/bin/linux/amd64/kubectl" -o /usr/local/bin/kubectl
  args:
    warn: false
  register: download_kubectl
  when: kubectl_exists is failed

- name: "kubectl - change file permissions"
  become: yes
  file:
    path: /usr/local/bin/kubectl
    mode: "0755"
  when: kubectl_exists is failed
